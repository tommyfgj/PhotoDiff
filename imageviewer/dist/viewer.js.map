{"version":3,"file":"viewer.js","sources":["../src/js/defaults.js","../src/js/template.js","../src/js/constants.js","../src/js/utilities.js","../src/js/render.js","../src/js/events.js","../src/js/handlers.js","../src/js/methods.js","../src/js/others.js","../src/js/viewer.js","../src/js/index.js"],"sourcesContent":["export default {\n  // Enable inline mode\n  inline: false,\n\n  // Show the button on the top-right of the viewer\n  button: true,\n\n  // Show the navbar\n  navbar: true,\n\n  // Show the title\n  title: true,\n\n  // Show the toolbar\n  toolbar: true,\n\n  // Show the tooltip with image ratio (percentage) when zoom in or zoom out\n  tooltip: true,\n\n  // Enable to move the image\n  movable: true,\n\n  // Enable to zoom the image\n  zoomable: true,\n\n  // Enable to rotate the image\n  rotatable: true,\n\n  // Enable to scale the image\n  scalable: true,\n\n  // Enable CSS3 Transition for some special elements\n  transition: true,\n\n  // Enable to request fullscreen when play\n  fullscreen: true,\n\n  // Enable keyboard support\n  keyboard: true,\n\n  // Define interval of each image when playing\n  interval: 5000,\n\n  // Min width of the viewer in inline mode\n  minWidth: 200,\n\n  // Min height of the viewer in inline mode\n  minHeight: 100,\n\n  // Define the ratio when zoom the image by wheeling mouse\n  zoomRatio: 0.1,\n\n  // Define the min ratio of the image when zoom out\n  minZoomRatio: 0.01,\n\n  // Define the max ratio of the image when zoom in\n  maxZoomRatio: 100,\n\n  // Define the CSS `z-index` value of viewer in modal mode.\n  zIndex: 2015,\n\n  // Define the CSS `z-index` value of viewer in inline mode.\n  zIndexInline: 0,\n\n  // Define where to get the original image URL for viewing\n  // Type: String (an image attribute) or Function (should return an image URL)\n  url: 'src',\n\n  // Event shortcuts\n  ready: null,\n  show: null,\n  shown: null,\n  hide: null,\n  hidden: null,\n  view: null,\n  viewed: null,\n};\n","export default (\n  '<div class=\"viewer-container\">' +\n    '<div class=\"viewer-canvas\"></div>' +\n    '<div class=\"viewer-footer\">' +\n      '<div class=\"viewer-title\"></div>' +\n      '<ul class=\"viewer-toolbar\">' +\n        '<li role=\"button\" class=\"viewer-zoom-in\" data-action=\"zoom-in\"></li>' +\n        '<li role=\"button\" class=\"viewer-zoom-out\" data-action=\"zoom-out\"></li>' +\n        '<li role=\"button\" class=\"viewer-one-to-one\" data-action=\"one-to-one\"></li>' +\n        '<li role=\"button\" class=\"viewer-reset\" data-action=\"reset\"></li>' +\n        '<li role=\"button\" class=\"viewer-prev\" data-action=\"prev\"></li>' +\n        '<li role=\"button\" class=\"viewer-play\" data-action=\"play\"></li>' +\n        '<li role=\"button\" class=\"viewer-next\" data-action=\"next\"></li>' +\n        '<li role=\"button\" class=\"viewer-rotate-left\" data-action=\"rotate-left\"></li>' +\n        '<li role=\"button\" class=\"viewer-rotate-right\" data-action=\"rotate-right\"></li>' +\n        '<li role=\"button\" class=\"viewer-flip-horizontal\" data-action=\"flip-horizontal\"></li>' +\n        '<li role=\"button\" class=\"viewer-flip-vertical\" data-action=\"flip-vertical\"></li>' +\n      '</ul>' +\n      '<div class=\"viewer-navbar\">' +\n        '<ul class=\"viewer-list\"></ul>' +\n      '</div>' +\n    '</div>' +\n    '<div class=\"viewer-tooltip\"></div>' +\n    '<div role=\"button\" class=\"viewer-button\" data-action=\"mix\"></div>' +\n    '<div class=\"viewer-player\"></div>' +\n  '</div>'\n);\n","const { PointerEvent } = window;\n\nexport const NAMESPACE = 'viewer';\n\n// Actions\nexport const ACTION_MOVE = 'move';\nexport const ACTION_SWITCH = 'switch';\nexport const ACTION_ZOOM = 'zoom';\n\n// Classes\nexport const CLASS_ACTIVE = `${NAMESPACE}-active`;\nexport const CLASS_CLOSE = `${NAMESPACE}-close`;\nexport const CLASS_FADE = `${NAMESPACE}-fade`;\nexport const CLASS_FIXED = `${NAMESPACE}-fixed`;\nexport const CLASS_FULLSCREEN = `${NAMESPACE}-fullscreen`;\nexport const CLASS_FULLSCREEN_EXIT = `${NAMESPACE}-fullscreen-exit`;\nexport const CLASS_HIDE = `${NAMESPACE}-hide`;\nexport const CLASS_HIDE_MD_DOWN = `${NAMESPACE}-hide-md-down`;\nexport const CLASS_HIDE_SM_DOWN = `${NAMESPACE}-hide-sm-down`;\nexport const CLASS_HIDE_XS_DOWN = `${NAMESPACE}-hide-xs-down`;\nexport const CLASS_IN = `${NAMESPACE}-in`;\nexport const CLASS_INVISIBLE = `${NAMESPACE}-invisible`;\nexport const CLASS_MOVE = `${NAMESPACE}-move`;\nexport const CLASS_OPEN = `${NAMESPACE}-open`;\nexport const CLASS_SHOW = `${NAMESPACE}-show`;\nexport const CLASS_TRANSITION = `${NAMESPACE}-transition`;\n\n// Events\nexport const EVENT_READY = 'ready';\nexport const EVENT_SHOW = 'show';\nexport const EVENT_SHOWN = 'shown';\nexport const EVENT_HIDE = 'hide';\nexport const EVENT_HIDDEN = 'hidden';\nexport const EVENT_VIEW = 'view';\nexport const EVENT_VIEWED = 'viewed';\nexport const EVENT_CLICK = 'click';\nexport const EVENT_DRAG_START = 'dragstart';\nexport const EVENT_KEY_DOWN = 'keydown';\nexport const EVENT_LOAD = 'load';\nexport const EVENT_POINTER_DOWN = PointerEvent ? 'pointerdown' : 'touchstart mousedown';\nexport const EVENT_POINTER_MOVE = PointerEvent ? 'pointermove' : 'mousemove touchmove';\nexport const EVENT_POINTER_UP = PointerEvent ? 'pointerup pointercancel' : 'touchend touchcancel mouseup';\nexport const EVENT_RESIZE = 'resize';\nexport const EVENT_TRANSITIONEND = 'transitionend';\nexport const EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\n","import $ from 'jquery';\nimport {\n  CLASS_HIDE_XS_DOWN,\n  CLASS_HIDE_SM_DOWN,\n  CLASS_HIDE_MD_DOWN,\n} from './constants';\n\n/**\n * Check if the given value is a string.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n */\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Check if the given value is not a number.\n */\nexport const isNaN = Number.isNaN || window.isNaN;\n\n/**\n * Check if the given value is a number.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n */\nexport function isNumber(value) {\n  return typeof value === 'number' && !isNaN(value);\n}\n\n/**\n * Check if the given value is undefined.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n */\nexport function isUndefined(value) {\n  return typeof value === 'undefined';\n}\n\n/**\n * Takes a function and returns a new one that will always have a particular context.\n * Custom proxy to avoid jQuery's guid.\n * @param {Function} fn - The target function.\n * @param {Object} context - The new context for the function.\n * @returns {boolean} The new function.\n */\nexport function proxy(fn, context, ...args) {\n  return (...args2) => fn.apply(context, args.concat(args2));\n}\n\n/**\n * Get the own enumerable properties of a given object.\n * @param {Object} obj - The target object.\n * @returns {Array} All the own enumerable properties of the given object.\n */\nexport const objectKeys = Object.keys || function objectKeys(obj) {\n  const keys = [];\n\n  $.each(obj, (key) => {\n    keys.push(key);\n  });\n\n  return keys;\n};\n\n/**\n * Get transform values from an object.\n * @param {Object} obj - The target object.\n * @returns {string} A string contains transform values.\n */\nexport function getTransformValues({ rotate, scaleX, scaleY }) {\n  const values = [];\n\n  if (isNumber(rotate) && rotate !== 0) {\n    values.push(`rotate(${rotate}deg)`);\n  }\n\n  if (isNumber(scaleX) && scaleX !== 1) {\n    values.push(`scaleX(${scaleX})`);\n  }\n\n  if (isNumber(scaleY) && scaleY !== 1) {\n    values.push(`scaleY(${scaleY})`);\n  }\n\n  return values.length > 0 ? values.join(' ') : 'none';\n}\n\n/**\n * Get an image name from an image url.\n * @param {string} url - The target url.\n * @example\n * // picture.jpg\n * getImageNameFromURL('http://domain.com/path/to/picture.jpg?size=1280×960')\n * @returns {string} A string contains the image name.\n */\nexport function getImageNameFromURL(url) {\n  return isString(url) ? url.replace(/^.*\\//, '').replace(/[?&#].*$/, '') : '';\n}\n\n/**\n * Get an image's natural sizes.\n * @param {string} image - The target image.\n * @param {Function} callback - The callback function.\n */\nexport function getImageNaturalSizes(image, callback) {\n  // Modern browsers and IE9+\n  if (image.naturalWidth) {\n    callback(image.naturalWidth, image.naturalHeight);\n    return;\n  }\n\n  // IE8 (Don't use `new Image()` here)\n  const newImage = document.createElement('img');\n\n  newImage.onload = () => {\n    callback(newImage.width, newImage.height);\n  };\n\n  newImage.src = image.src;\n}\n\n/**\n * Get the related class name of a responsive type number.\n * @param {string} type - The responsive type.\n * @returns {string} The related class name.\n */\nexport function getResponsiveClass(type) {\n  switch (type) {\n    case 2:\n      return CLASS_HIDE_XS_DOWN;\n\n    case 3:\n      return CLASS_HIDE_SM_DOWN;\n\n    case 4:\n      return CLASS_HIDE_MD_DOWN;\n\n    default:\n      return '';\n  }\n}\n\n/**\n * Get the max ratio of a group of pointers.\n * @param {string} pointers - The target pointers.\n * @returns {number} The result ratio.\n */\nexport function getMaxZoomRatio(pointers) {\n  const pointers2 = $.extend({}, pointers);\n  const ratios = [];\n\n  $.each(pointers, (pointerId, pointer) => {\n    delete pointers2[pointerId];\n\n    $.each(pointers2, (pointerId2, pointer2) => {\n      const x1 = Math.abs(pointer.startX - pointer2.startX);\n      const y1 = Math.abs(pointer.startY - pointer2.startY);\n      const x2 = Math.abs(pointer.endX - pointer2.endX);\n      const y2 = Math.abs(pointer.endY - pointer2.endY);\n      const z1 = Math.sqrt((x1 * x1) + (y1 * y1));\n      const z2 = Math.sqrt((x2 * x2) + (y2 * y2));\n      const ratio = (z2 - z1) / z1;\n\n      ratios.push(ratio);\n    });\n  });\n\n  ratios.sort((a, b) => Math.abs(a) < Math.abs(b));\n\n  return ratios[0];\n}\n\n/**\n * Get a pointer from an event object.\n * @param {Object} event - The target event object.\n * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n * @returns {Object} The result pointer contains start and/or end point coordinates.\n */\nexport function getPointer({ pageX, pageY }, endOnly) {\n  const end = {\n    endX: pageX,\n    endY: pageY,\n  };\n\n  if (endOnly) {\n    return end;\n  }\n\n  return $.extend({\n    startX: pageX,\n    startY: pageY,\n  }, end);\n}\n\n/**\n * Get the center point coordinate of a group of pointers.\n * @param {Object} pointers - The target pointers.\n * @returns {Object} The center point coordinate.\n */\nexport function getPointersCenter(pointers) {\n  let pageX = 0;\n  let pageY = 0;\n  let count = 0;\n\n  $.each(pointers, (pointerId, { startX, startY }) => {\n    pageX += startX;\n    pageY += startY;\n    count += 1;\n  });\n\n  pageX /= count;\n  pageY /= count;\n\n  return {\n    pageX,\n    pageY,\n  };\n}\n","import $ from 'jquery';\nimport {\n  CLASS_TRANSITION,\n  EVENT_LOAD,\n  EVENT_VIEWED,\n  EVENT_TRANSITIONEND,\n} from './constants';\nimport {\n  isString,\n  getImageNameFromURL,\n  getImageNaturalSizes,\n  getTransformValues,\n} from './utilities';\n\nexport default {\n  render() {\n    this.initContainer();\n    this.initViewer();\n    this.initList();\n    this.renderViewer();\n  },\n\n  initContainer() {\n    const $window = $(window);\n\n    this.container = {\n      width: $window.innerWidth(),\n      height: $window.innerHeight(),\n    };\n  },\n\n  initViewer() {\n    const { options, $parent } = this;\n    let viewer;\n\n    if (options.inline) {\n      viewer = {\n        width: Math.max($parent.width(), options.minWidth),\n        height: Math.max($parent.height(), options.minHeight),\n      };\n      this.parent = viewer;\n    }\n\n    if (this.fulled || !viewer) {\n      viewer = this.container;\n    }\n\n    this.viewer = $.extend({}, viewer);\n  },\n\n  renderViewer() {\n    if (this.options.inline && !this.fulled) {\n      this.$viewer.css(this.viewer);\n    }\n  },\n\n  initList() {\n    const { $element, options, $list } = this;\n    const list = [];\n\n    this.$images.each((i, image) => {\n      const alt = image.alt || getImageNameFromURL(image);\n      const { src } = image;\n      let { url } = options;\n\n      if (!src) {\n        return;\n      }\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if ($.isFunction(url)) {\n        url = url.call(image, image);\n      }\n\n      list.push('<li>' +\n        '<img' +\n          ` src=\"${src}\"` +\n          ' data-action=\"view\"' +\n          ` data-index=\"${i}\"` +\n          ` data-original-url=\"${url || src}\"` +\n          ` alt=\"${alt}\"` +\n        '>' +\n      '</li>');\n    });\n\n    $list.html(list.join('')).find('img').one(EVENT_LOAD, {\n      filled: true,\n    }, $.proxy(this.loadImage, this));\n\n    this.$items = $list.children();\n\n    if (options.transition) {\n      $element.one(EVENT_VIEWED, () => {\n        $list.addClass(CLASS_TRANSITION);\n      });\n    }\n  },\n\n  renderList(index) {\n    const i = index || this.index;\n    const width = this.$items.eq(i).width();\n\n    // 1 pixel of `margin-left` width\n    const outerWidth = width + 1;\n\n    // Place the active item in the center of the screen\n    this.$list.css({\n      width: outerWidth * this.length,\n      marginLeft: ((this.viewer.width - width) / 2) - (outerWidth * i),\n    });\n  },\n\n  resetList() {\n    this.$list.empty().removeClass(CLASS_TRANSITION).css('margin-left', 0);\n  },\n\n  initImage(callback) {\n    const { options, $image, viewer } = this;\n    const footerHeight = this.$footer.height();\n    const viewerWidth = viewer.width;\n    const viewerHeight = Math.max(viewer.height - footerHeight, footerHeight);\n    const oldImage = this.image || {};\n\n    getImageNaturalSizes($image[0], (naturalWidth, naturalHeight) => {\n      const aspectRatio = naturalWidth / naturalHeight;\n      let width = viewerWidth;\n      let height = viewerHeight;\n\n      if (viewerHeight * aspectRatio > viewerWidth) {\n        height = viewerWidth / aspectRatio;\n      } else {\n        width = viewerHeight * aspectRatio;\n      }\n\n      width = Math.min(width * 0.9, naturalWidth);\n      height = Math.min(height * 0.9, naturalHeight);\n\n      const image = {\n        naturalWidth,\n        naturalHeight,\n        aspectRatio,\n        ratio: width / naturalWidth,\n        width,\n        height,\n        left: (viewerWidth - width) / 2,\n        top: (viewerHeight - height) / 2,\n      };\n      const initialImage = $.extend({}, image);\n\n      if (options.rotatable) {\n        image.rotate = oldImage.rotate || 0;\n        initialImage.rotate = 0;\n      }\n\n      if (options.scalable) {\n        image.scaleX = oldImage.scaleX || 1;\n        image.scaleY = oldImage.scaleY || 1;\n        initialImage.scaleX = 1;\n        initialImage.scaleY = 1;\n      }\n\n      this.image = image;\n      this.initialImage = initialImage;\n\n      if ($.isFunction(callback)) {\n        callback();\n      }\n    });\n  },\n\n  renderImage(callback) {\n    const { image, $image } = this;\n\n    $image.css({\n      width: image.width,\n      height: image.height,\n      marginLeft: image.left,\n      marginTop: image.top,\n      transform: getTransformValues(image),\n    });\n\n    if ($.isFunction(callback)) {\n      if (this.transitioning) {\n        $image.one(EVENT_TRANSITIONEND, callback);\n      } else {\n        callback();\n      }\n    }\n  },\n\n  resetImage() {\n    if (this.$image) {\n      this.$image.remove();\n      this.$image = null;\n    }\n  },\n};\n","import $ from 'jquery';\nimport {\n  EVENT_CLICK,\n  EVENT_DRAG_START,\n  EVENT_KEY_DOWN,\n  EVENT_POINTER_DOWN,\n  EVENT_POINTER_MOVE,\n  EVENT_POINTER_UP,\n  EVENT_RESIZE,\n  EVENT_VIEW,\n  EVENT_VIEWED,\n  EVENT_WHEEL,\n} from './constants';\nimport {\n  proxy,\n} from './utilities';\n\nexport default {\n  bind() {\n    const { $element, options } = this;\n\n    if ($.isFunction(options.view)) {\n      $element.on(EVENT_VIEW, options.view);\n    }\n\n    if ($.isFunction(options.viewed)) {\n      $element.on(EVENT_VIEWED, options.viewed);\n    }\n\n    this.$viewer\n      .on(EVENT_CLICK, $.proxy(this.click, this))\n      .on(EVENT_WHEEL, $.proxy(this.wheel, this))\n      .on(EVENT_DRAG_START, $.proxy(this.dragstart, this));\n\n    this.$canvas.on(EVENT_POINTER_DOWN, $.proxy(this.pointerdown, this));\n\n    $(document)\n      .on(EVENT_POINTER_MOVE, (this.onPointerMove = proxy(this.pointermove, this)))\n      .on(EVENT_POINTER_UP, (this.onPointerUp = proxy(this.pointerup, this)))\n      .on(EVENT_KEY_DOWN, (this.onKeyDown = proxy(this.keydown, this)));\n\n    $(window).on(EVENT_RESIZE, (this.onResize = proxy(this.resize, this)));\n  },\n\n  unbind() {\n    const { $element, options } = this;\n\n    if ($.isFunction(options.view)) {\n      $element.off(EVENT_VIEW, options.view);\n    }\n\n    if ($.isFunction(options.viewed)) {\n      $element.off(EVENT_VIEWED, options.viewed);\n    }\n\n    this.$viewer\n      .off(EVENT_CLICK, this.click)\n      .off(EVENT_WHEEL, this.wheel)\n      .off(EVENT_DRAG_START, this.dragstart);\n\n    this.$canvas.off(EVENT_POINTER_DOWN, this.pointerdown);\n\n    $(document)\n      .off(EVENT_POINTER_MOVE, this.onPointerMove)\n      .off(EVENT_POINTER_UP, this.onPointerUp)\n      .off(EVENT_KEY_DOWN, this.onKeyDown);\n\n    $(window).off(EVENT_RESIZE, this.onResize);\n  },\n};\n","import $ from 'jquery';\nimport {\n  ACTION_MOVE,\n  ACTION_SWITCH,\n  ACTION_ZOOM,\n  CLASS_INVISIBLE,\n  CLASS_MOVE,\n  CLASS_TRANSITION,\n  EVENT_LOAD,\n  EVENT_VIEWED,\n} from './constants';\nimport {\n  objectKeys,\n  getPointer,\n  getImageNaturalSizes,\n} from './utilities';\n\nexport default {\n  click(e) {\n    const $target = $(e.target);\n    const action = $target.data('action');\n    const { image } = this;\n\n    switch (action) {\n      case 'mix':\n        if (this.played) {\n          this.stop();\n        } else if (this.options.inline) {\n          if (this.fulled) {\n            this.exit();\n          } else {\n            this.full();\n          }\n        } else {\n          this.hide();\n        }\n\n        break;\n\n      case 'view':\n        this.view($target.data('index'));\n        break;\n\n      case 'zoom-in':\n        this.zoom(0.1, true);\n        break;\n\n      case 'zoom-out':\n        this.zoom(-0.1, true);\n        break;\n\n      case 'one-to-one':\n        this.toggle();\n        break;\n\n      case 'reset':\n        this.reset();\n        break;\n\n      case 'prev':\n        this.prev();\n        break;\n\n      case 'play':\n        this.play();\n        break;\n\n      case 'next':\n        this.next();\n        break;\n\n      case 'rotate-left':\n        this.rotate(-90);\n        break;\n\n      case 'rotate-right':\n        this.rotate(90);\n        break;\n\n      case 'flip-horizontal':\n        this.scaleX(-image.scaleX || -1);\n        break;\n\n      case 'flip-vertical':\n        this.scaleY(-image.scaleY || -1);\n        break;\n\n      default:\n        if (this.played) {\n          this.stop();\n        }\n    }\n  },\n\n  dragstart(e) {\n    if ($(e.target).is('img')) {\n      e.preventDefault();\n    }\n  },\n\n  keydown(e) {\n    const { options } = this;\n\n    if (!this.fulled || !options.keyboard) {\n      return;\n    }\n\n    switch (e.which) {\n      // (Key: Esc)\n      case 27:\n        if (this.played) {\n          this.stop();\n        } else if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n        } else {\n          this.hide();\n        }\n\n        break;\n\n      // (Key: Space)\n      case 32:\n        if (this.played) {\n          this.stop();\n        }\n\n        break;\n\n      // View previous (Key: ←)\n      case 37:\n        this.prev();\n        break;\n\n      // Zoom in (Key: ↑)\n      case 38:\n        // Prevent scroll on Firefox\n        e.preventDefault();\n\n        this.zoom(options.zoomRatio, true);\n        break;\n\n      // View next (Key: →)\n      case 39:\n        this.next();\n        break;\n\n      // Zoom out (Key: ↓)\n      case 40:\n        // Prevent scroll on Firefox\n        e.preventDefault();\n\n        this.zoom(-options.zoomRatio, true);\n        break;\n\n      // 48: Zoom out to initial size (Key: Ctrl + 0)\n      // 49: Zoom in to natural size (Key: Ctrl + 1)\n      case 48:\n      case 49:\n        if (e.ctrlKey || e.shiftKey) {\n          e.preventDefault();\n          this.toggle();\n        }\n\n        break;\n\n      default:\n    }\n  },\n\n  load() {\n    const { options, viewer, $image } = this;\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = false;\n    }\n\n    if (!$image) {\n      return;\n    }\n\n    $image.removeClass(CLASS_INVISIBLE).css(\n      'cssText', (\n        `${'width:0;' +\n      'height:0;' +\n      'margin-left:'}${viewer.width / 2}px;` +\n      `margin-top:${viewer.height / 2}px;` +\n      'max-width:none!important;' +\n      'visibility:visible;'\n      ),\n    );\n\n    this.initImage(() => {\n      $image\n        .toggleClass(CLASS_TRANSITION, options.transition)\n        .toggleClass(CLASS_MOVE, options.movable);\n\n      this.renderImage(() => {\n        this.viewed = true;\n        this.trigger(EVENT_VIEWED);\n      });\n    });\n  },\n\n  loadImage(e) {\n    const image = e.target;\n    const $image = $(image);\n    const $parent = $image.parent();\n    const parentWidth = $parent.width();\n    const parentHeight = $parent.height();\n    const filled = e.data && e.data.filled;\n\n    getImageNaturalSizes(image, (naturalWidth, naturalHeight) => {\n      const aspectRatio = naturalWidth / naturalHeight;\n      let width = parentWidth;\n      let height = parentHeight;\n\n      if (parentHeight * aspectRatio > parentWidth) {\n        if (filled) {\n          width = parentHeight * aspectRatio;\n        } else {\n          height = parentWidth / aspectRatio;\n        }\n      } else if (filled) {\n        height = parentWidth / aspectRatio;\n      } else {\n        width = parentHeight * aspectRatio;\n      }\n\n      $image.css({\n        width,\n        height,\n        marginLeft: (parentWidth - width) / 2,\n        marginTop: (parentHeight - height) / 2,\n      });\n    });\n  },\n\n  pointerdown(e) {\n    if (!this.viewed || this.transitioning) {\n      return;\n    }\n\n    const { options, pointers } = this;\n    const { originalEvent } = e;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, (i, touch) => {\n        pointers[touch.identifier] = getPointer(touch);\n      });\n    } else {\n      pointers[(originalEvent && originalEvent.pointerId) || 0] = getPointer(originalEvent || e);\n    }\n\n    let action = options.movable ? ACTION_MOVE : false;\n\n    if (objectKeys(pointers).length > 1) {\n      action = ACTION_ZOOM;\n    } else if ((e.pointerType === 'touch' || e.type === 'touchmove') && this.isSwitchable()) {\n      action = ACTION_SWITCH;\n    }\n\n    this.action = action;\n  },\n\n  pointermove(e) {\n    const {\n      $image,\n      action,\n      pointers,\n    } = this;\n\n    if (!this.viewed || !action) {\n      return;\n    }\n\n    e.preventDefault();\n\n    const { originalEvent } = e;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, (i, touch) => {\n        $.extend(pointers[touch.identifier], getPointer(touch, true));\n      });\n    } else {\n      $.extend(\n        pointers[(originalEvent && originalEvent.pointerId) || 0],\n        getPointer(e, true),\n      );\n    }\n\n    if (action === ACTION_MOVE && this.options.transition && $image.hasClass(CLASS_TRANSITION)) {\n      $image.removeClass(CLASS_TRANSITION);\n    }\n\n    this.change(e);\n  },\n\n  pointerup(e) {\n    if (!this.viewed) {\n      return;\n    }\n\n    const { action, pointers } = this;\n    const { originalEvent } = e;\n\n    if (originalEvent && originalEvent.changedTouches) {\n      $.each(originalEvent.changedTouches, (i, touch) => {\n        delete pointers[touch.identifier];\n      });\n    } else {\n      delete pointers[(originalEvent && originalEvent.pointerId) || 0];\n    }\n\n    if (!action) {\n      return;\n    }\n\n    if (action === ACTION_MOVE && this.options.transition) {\n      this.$image.addClass(CLASS_TRANSITION);\n    }\n\n    this.action = false;\n  },\n\n  resize() {\n    this.initContainer();\n    this.initViewer();\n    this.renderViewer();\n    this.renderList();\n\n    if (this.viewed) {\n      this.initImage(() => {\n        this.renderImage();\n      });\n    }\n\n    if (this.played) {\n      if (this.options.fullscreen && this.fulled &&\n        !document.fullscreenElement &&\n        !document.mozFullScreenElement &&\n        !document.webkitFullscreenElement &&\n        !document.msFullscreenElement) {\n        this.stop();\n        return;\n      }\n\n      this.$player\n        .find('img')\n        .one(EVENT_LOAD, $.proxy(this.loadImage, this))\n        .trigger(EVENT_LOAD);\n    }\n  },\n\n  start({ target }) {\n    if ($(target).is('img')) {\n      this.target = target;\n      this.show();\n    }\n  },\n\n  wheel(e) {\n    if (!this.viewed) {\n      return;\n    }\n\n    e.preventDefault();\n\n    // Limit wheel speed to prevent zoom too fast\n    if (this.wheeling) {\n      return;\n    }\n\n    this.wheeling = true;\n\n    setTimeout(() => {\n      this.wheeling = false;\n    }, 50);\n\n    const originalEvent = e.originalEvent || e;\n    let delta = 1;\n\n    if (originalEvent.deltaY) {\n      delta = originalEvent.deltaY > 0 ? 1 : -1;\n    } else if (originalEvent.wheelDelta) {\n      delta = -originalEvent.wheelDelta / 120;\n    } else if (originalEvent.detail) {\n      delta = originalEvent.detail > 0 ? 1 : -1;\n    }\n\n    this.zoom(-delta * (Number(this.options.zoomRatio) || 0.1), true, e);\n  },\n};\n","import $ from 'jquery';\nimport {\n  CLASS_ACTIVE,\n  CLASS_FADE,\n  CLASS_FIXED,\n  CLASS_FULLSCREEN_EXIT,\n  CLASS_HIDE,\n  CLASS_IN,\n  CLASS_INVISIBLE,\n  CLASS_OPEN,\n  CLASS_SHOW,\n  CLASS_TRANSITION,\n  EVENT_CLICK,\n  EVENT_HIDE,\n  EVENT_LOAD,\n  EVENT_SHOW,\n  EVENT_SHOWN,\n  EVENT_TRANSITIONEND,\n  EVENT_VIEW,\n  EVENT_VIEWED,\n  NAMESPACE,\n} from './constants';\nimport {\n  isUndefined,\n  isNumber,\n  objectKeys,\n  getPointersCenter,\n} from './utilities';\n\nexport default {\n  /**\n   * Show the viewer (only available in modal mode).\n   */\n  show() {\n    const { $element, options } = this;\n\n    if (options.inline || this.transitioning) {\n      return;\n    }\n\n    if (!this.ready) {\n      this.build();\n    }\n\n    const { $viewer } = this;\n\n    if ($.isFunction(options.show)) {\n      $element.one(EVENT_SHOW, options.show);\n    }\n\n    if (this.trigger(EVENT_SHOW).isDefaultPrevented()) {\n      return;\n    }\n\n    this.$body.addClass(CLASS_OPEN);\n    $viewer.removeClass(CLASS_HIDE);\n    $element.one(EVENT_SHOWN, () => {\n      this.view(this.target ? this.$images.index(this.target) : this.index);\n      this.target = false;\n    });\n\n    if (options.transition) {\n      this.transitioning = true;\n      $viewer.addClass(CLASS_TRANSITION);\n\n      // Force reflow to enable CSS3 transition\n      // eslint-disable-next-line\n      $viewer[0].offsetWidth;\n      $viewer.one(EVENT_TRANSITIONEND, $.proxy(this.shown, this)).addClass(CLASS_IN);\n    } else {\n      $viewer.addClass(CLASS_IN);\n      this.shown();\n    }\n  },\n\n  /**\n   * Hide the viewer (only available in modal mode).\n   */\n  hide() {\n    const { options, $viewer } = this;\n\n    if (options.inline || this.transitioning || !this.visible) {\n      return;\n    }\n\n    if ($.isFunction(options.hide)) {\n      this.$element.one(EVENT_HIDE, options.hide);\n    }\n\n    if (this.trigger(EVENT_HIDE).isDefaultPrevented()) {\n      return;\n    }\n\n    if (this.viewed && options.transition) {\n      this.transitioning = true;\n      this.$image.one(EVENT_TRANSITIONEND, () => {\n        $viewer.one(EVENT_TRANSITIONEND, $.proxy(this.hidden, this)).removeClass(CLASS_IN);\n      });\n      this.zoomTo(0, false, false, true);\n    } else {\n      $viewer.removeClass(CLASS_IN);\n      this.hidden();\n    }\n  },\n\n  /**\n   * View one of the images with image's index.\n   * @param {number} index - The image index.\n   */\n  view(index) {\n    index = Number(index) || 0;\n\n    if (!this.visible || this.played || index < 0 || index >= this.length ||\n      (this.viewed && index === this.index)) {\n      return;\n    }\n\n    if (this.trigger(EVENT_VIEW).isDefaultPrevented()) {\n      return;\n    }\n\n    const $item = this.$items.eq(index);\n    const $img = $item.find('img');\n    const alt = $img.attr('alt');\n    const $image = $(`<img src=\"${$img.data('originalUrl')}\" alt=\"${alt}\">`);\n\n    this.$image = $image;\n    this.$items.eq(this.index).removeClass(CLASS_ACTIVE);\n    $item.addClass(CLASS_ACTIVE);\n    this.viewed = false;\n    this.index = index;\n    this.image = null;\n    this.$canvas.html($image.addClass(CLASS_INVISIBLE));\n\n    // Center current item\n    this.renderList();\n\n    const { $title } = this;\n\n    // Clear title\n    $title.empty();\n\n    // Generate title after viewed\n    this.$element.one(EVENT_VIEWED, () => {\n      const { naturalWidth, naturalHeight } = this.image;\n\n      $title.html(`${alt} (${naturalWidth} &times; ${naturalHeight})`);\n    });\n\n    if ($image[0].complete) {\n      this.load();\n    } else {\n      $image.one(EVENT_LOAD, $.proxy(this.load, this));\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n      }\n\n      // Make the image visible if it fails to load within 1s\n      this.timeout = setTimeout(() => {\n        $image.removeClass(CLASS_INVISIBLE);\n        this.timeout = false;\n      }, 1000);\n    }\n  },\n\n  /**\n   * View the previous image.\n   */\n  prev() {\n    this.view(Math.max(this.index - 1, 0));\n  },\n\n  /**\n   * View the next image.\n   */\n  next() {\n    this.view(Math.min(this.index + 1, this.length - 1));\n  },\n\n  /**\n   * Move the image with relative offsets.\n   * @param {number} offsetX - The relative offset distance on the x-axis.\n   * @param {number} offsetY - The relative offset distance on the y-axis.\n   */\n  move(offsetX, offsetY) {\n    const { left, top } = this.image;\n\n    this.moveTo(\n      isUndefined(offsetX) ? offsetX : left + Number(offsetX),\n      isUndefined(offsetY) ? offsetY : top + Number(offsetY),\n    );\n  },\n\n  /**\n   * Move the image to an absolute point.\n   * @param {number} x - The x-axis coordinate.\n   * @param {number} [y=x] - The y-axis coordinate.\n   */\n  moveTo(x, y = x) {\n    if (!this.viewed || this.played || !this.options.movable) {\n      return;\n    }\n\n    const { image } = this;\n    let changed = false;\n\n    x = Number(x);\n    y = Number(y);\n\n    if (isNumber(x)) {\n      image.left = x;\n      changed = true;\n    }\n\n    if (isNumber(y)) {\n      image.top = y;\n      changed = true;\n    }\n\n    if (changed) {\n      this.renderImage();\n    }\n  },\n\n  /**\n   * Zoom the image with a relative ratio.\n   * @param {number} ratio - The target ratio.\n   * @param {boolean} [hasTooltip] - Indicates if it has a tooltip or not.\n   * @param {Event} [_event] - The related event if any.\n   */\n  zoom(ratio, hasTooltip = false, _event = null) {\n    const { image } = this;\n\n    ratio = Number(ratio);\n\n    if (ratio < 0) {\n      ratio = 1 / (1 - ratio);\n    } else {\n      ratio = 1 + ratio;\n    }\n\n    this.zoomTo((image.width * ratio) / image.naturalWidth, hasTooltip, _event);\n  },\n\n  /**\n   * Zoom the image to an absolute ratio.\n   * @param {number} ratio - The target ratio.\n   * @param {boolean} [hasTooltip] - Indicates if it has a tooltip or not.\n   * @param {Event} [_event] - The related event if any.\n   * @param {Event} [_zoomable] - Indicates if the current zoom is available or not.\n   */\n  zoomTo(ratio, hasTooltip = false, _event = null, _zoomable = false) {\n    const { options, image, pointers } = this;\n\n    ratio = Math.max(0, ratio);\n\n    if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n      if (!_zoomable) {\n        const minZoomRatio = Math.max(0.01, options.minZoomRatio);\n        const maxZoomRatio = Math.min(100, options.maxZoomRatio);\n\n        ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n      }\n\n      if (_event && ratio > 0.95 && ratio < 1.05) {\n        ratio = 1;\n      }\n\n      const newWidth = image.naturalWidth * ratio;\n      const newHeight = image.naturalHeight * ratio;\n\n      if (_event && _event.originalEvent) {\n        const offset = this.$viewer.offset();\n        const center = pointers && objectKeys(pointers).length > 0 ? getPointersCenter(pointers) : {\n          pageX: _event.pageX || _event.originalEvent.pageX || 0,\n          pageY: _event.pageY || _event.originalEvent.pageY || 0,\n        };\n\n        // Zoom from the triggering point of the event\n        image.left -= (newWidth - image.width) * (\n          ((center.pageX - offset.left) - image.left) / image.width\n        );\n        image.top -= (newHeight - image.height) * (\n          ((center.pageY - offset.top) - image.top) / image.height\n        );\n      } else {\n        // Zoom from the center of the image\n        image.left -= (newWidth - image.width) / 2;\n        image.top -= (newHeight - image.height) / 2;\n      }\n\n      image.width = newWidth;\n      image.height = newHeight;\n      image.ratio = ratio;\n      this.renderImage();\n\n      if (hasTooltip) {\n        this.tooltip();\n      }\n    }\n  },\n\n  /**\n   * Rotate the image with a relative degree.\n   * @param {number} degree - The rotate degree.\n   */\n  rotate(degree) {\n    this.rotateTo((this.image.rotate || 0) + Number(degree));\n  },\n\n  /**\n   * Rotate the image to an absolute degree.\n   * @param {number} degree - The rotate degree.\n   */\n  rotateTo(degree) {\n    const { image } = this;\n\n    degree = Number(degree);\n\n    if (isNumber(degree) && this.viewed && !this.played && this.options.rotatable) {\n      image.rotate = degree;\n      this.renderImage();\n    }\n  },\n\n  /**\n   * Scale the image on the x-axis.\n   * @param {number} scaleX - The scale ratio on the x-axis.\n   */\n  scaleX(scaleX) {\n    this.scale(scaleX, this.image.scaleY);\n  },\n\n  /**\n   * Scale the image on the y-axis.\n   * @param {number} scaleY - The scale ratio on the y-axis.\n   */\n  scaleY(scaleY) {\n    this.scale(this.image.scaleX, scaleY);\n  },\n\n  /**\n   * Scale the image.\n   * @param {number} scaleX - The scale ratio on the x-axis.\n   * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n   */\n  scale(scaleX, scaleY = scaleX) {\n    if (!this.viewed || this.played || !this.options.scalable) {\n      return;\n    }\n\n    const { image } = this;\n    let changed = false;\n\n    scaleX = Number(scaleX);\n    scaleY = Number(scaleY);\n\n    if (isNumber(scaleX)) {\n      image.scaleX = scaleX;\n      changed = true;\n    }\n\n    if (isNumber(scaleY)) {\n      image.scaleY = scaleY;\n      changed = true;\n    }\n\n    if (changed) {\n      this.renderImage();\n    }\n  },\n\n  /**\n   * Play the images.\n   */\n  play() {\n    if (!this.visible || this.played) {\n      return;\n    }\n\n    const { options, $items, $player } = this;\n\n    if (options.fullscreen) {\n      this.requestFullscreen();\n    }\n\n    this.played = true;\n    $player.addClass(CLASS_SHOW);\n\n    const list = [];\n    let index = 0;\n\n    $items.each((i, item) => {\n      const $item = $(item);\n      const $img = $item.find('img');\n      const $image = $(`<img src=\"${$img.data('originalUrl')}\" alt=\"${$img.attr('alt')}\">`);\n\n      $image.addClass(CLASS_FADE).toggleClass(CLASS_TRANSITION, options.transition);\n\n      if ($item.hasClass(CLASS_ACTIVE)) {\n        $image.addClass(CLASS_IN);\n        index = i;\n      }\n\n      list.push($image);\n      $image.one(EVENT_LOAD, {\n        filled: false,\n      }, $.proxy(this.loadImage, this));\n      $player.append($image);\n    });\n\n    if (isNumber(options.interval) && options.interval > 0) {\n      const { length } = $items;\n      const playing = () => {\n        this.playing = setTimeout(() => {\n          list[index].removeClass(CLASS_IN);\n          index += 1;\n          index = index < length ? index : 0;\n          list[index].addClass(CLASS_IN);\n          playing();\n        }, options.interval);\n      };\n\n      if (length > 1) {\n        playing();\n      }\n    }\n  },\n\n  /**\n   * Stop play.\n   */\n  stop() {\n    if (!this.played) {\n      return;\n    }\n\n    if (this.options.fullscreen) {\n      this.exitFullscreen();\n    }\n\n    this.played = false;\n    clearTimeout(this.playing);\n    this.$player.removeClass(CLASS_SHOW).empty();\n  },\n\n  /**\n   * Enter modal mode (only available in inline mode).\n   */\n  full() {\n    const { options, $image, $list } = this;\n\n    if (!this.visible || this.played || this.fulled || !options.inline) {\n      return;\n    }\n\n    this.fulled = true;\n    this.$body.addClass(CLASS_OPEN);\n    this.$button.addClass(CLASS_FULLSCREEN_EXIT);\n\n    if (options.transition) {\n      $image.removeClass(CLASS_TRANSITION);\n      $list.removeClass(CLASS_TRANSITION);\n    }\n\n    this.$viewer.addClass(CLASS_FIXED).removeAttr('style').css('z-index', options.zIndex);\n    this.initContainer();\n    this.viewer = $.extend({}, this.container);\n    this.renderList();\n    this.initImage(() => {\n      this.renderImage(() => {\n        if (options.transition) {\n          setTimeout(() => {\n            $image.addClass(CLASS_TRANSITION);\n            $list.addClass(CLASS_TRANSITION);\n          }, 0);\n        }\n      });\n    });\n  },\n\n  /**\n   * Exit modal mode (only available in inline mode).\n   */\n  exit() {\n    if (!this.fulled) {\n      return;\n    }\n\n    const { options, $image, $list } = this;\n\n    this.fulled = false;\n    this.$body.removeClass(CLASS_OPEN);\n    this.$button.removeClass(CLASS_FULLSCREEN_EXIT);\n\n    if (options.transition) {\n      $image.removeClass(CLASS_TRANSITION);\n      $list.removeClass(CLASS_TRANSITION);\n    }\n\n    this.$viewer.removeClass(CLASS_FIXED).css('z-index', options.zIndexInline);\n    this.viewer = $.extend({}, this.parent);\n    this.renderViewer();\n    this.renderList();\n    this.initImage(() => {\n      this.renderImage(() => {\n        if (options.transition) {\n          setTimeout(() => {\n            $image.addClass(CLASS_TRANSITION);\n            $list.addClass(CLASS_TRANSITION);\n          }, 0);\n        }\n      });\n    });\n  },\n\n  /**\n   * Show the current ratio of the image with percentage.\n   */\n  tooltip() {\n    const { options, $tooltip, image } = this;\n    const classes = [\n      CLASS_SHOW,\n      CLASS_FADE,\n      CLASS_TRANSITION,\n    ].join(' ');\n\n    if (!this.viewed || this.played || !options.tooltip) {\n      return;\n    }\n\n    $tooltip.text(`${Math.round(image.ratio * 100)}%`);\n\n    if (!this.tooltiping) {\n      if (options.transition) {\n        if (this.fading) {\n          $tooltip.trigger(EVENT_TRANSITIONEND);\n        }\n\n        $tooltip.addClass(classes);\n\n        // Force reflow to enable CSS3 transition\n        // eslint-disable-next-line\n        $tooltip[0].offsetWidth;\n        $tooltip.addClass(CLASS_IN);\n      } else {\n        $tooltip.addClass(CLASS_SHOW);\n      }\n    } else {\n      clearTimeout(this.tooltiping);\n    }\n\n    this.tooltiping = setTimeout(() => {\n      if (options.transition) {\n        $tooltip.one(EVENT_TRANSITIONEND, () => {\n          $tooltip.removeClass(classes);\n          this.fading = false;\n        }).removeClass(CLASS_IN);\n\n        this.fading = true;\n      } else {\n        $tooltip.removeClass(CLASS_SHOW);\n      }\n\n      this.tooltiping = false;\n    }, 1000);\n  },\n\n  /**\n   * Toggle the image size between its natural size and initial size.\n   */\n  toggle() {\n    if (this.image.ratio === 1) {\n      this.zoomTo(this.initialImage.ratio, true);\n    } else {\n      this.zoomTo(1, true);\n    }\n  },\n\n  /**\n   * Reset the image to its initial state.\n   */\n  reset() {\n    if (this.viewed && !this.played) {\n      this.image = $.extend({}, this.initialImage);\n      this.renderImage();\n    }\n  },\n\n  /**\n   * Update viewer when images changed.\n   */\n  update() {\n    const { $element } = this;\n    let { $images } = this;\n\n    if (this.isImg) {\n      // Destroy viewer if the target image was deleted\n      if (!$element.parent().length) {\n        this.destroy();\n        return;\n      }\n    } else {\n      $images = $element.find('img');\n      this.$images = $images;\n      this.length = $images.length;\n    }\n\n    if (this.ready) {\n      const indexes = [];\n      let index;\n\n      $.each(this.$items, (i, item) => {\n        const img = $(item).find('img')[0];\n        const image = $images[i];\n\n        if (image) {\n          if (image.src !== img.src) {\n            indexes.push(i);\n          }\n        } else {\n          indexes.push(i);\n        }\n      });\n\n      this.$list.width('auto');\n      this.initList();\n\n      if (this.visible) {\n        if (this.length) {\n          if (this.viewed) {\n            index = $.inArray(this.index, indexes);\n\n            if (index >= 0) {\n              this.viewed = false;\n              this.view(Math.max(this.index - (index + 1), 0));\n            } else {\n              this.$items.eq(this.index).addClass(CLASS_ACTIVE);\n            }\n          }\n        } else {\n          this.$image = null;\n          this.viewed = false;\n          this.index = 0;\n          this.image = null;\n          this.$canvas.empty();\n          this.$title.empty();\n        }\n      }\n    }\n  },\n\n  /**\n   * Destroy the viewer instance.\n   */\n  destroy() {\n    const { $element } = this;\n\n    if (this.options.inline) {\n      this.unbind();\n    } else {\n      if (this.visible) {\n        this.unbind();\n      }\n\n      $element.off(EVENT_CLICK, this.start);\n    }\n\n    this.unbuild();\n    $element.removeData(NAMESPACE);\n  },\n};\n","import $ from 'jquery';\nimport {\n  ACTION_MOVE,\n  ACTION_SWITCH,\n  ACTION_ZOOM,\n  CLASS_HIDE,\n  CLASS_OPEN,\n  EVENT_HIDDEN,\n  EVENT_SHOWN,\n} from './constants';\nimport {\n  getMaxZoomRatio,\n} from './utilities';\n\nconst { document } = window;\n\nexport default {\n  // A shortcut for triggering custom events\n  trigger(type, data) {\n    const e = $.Event(type, data);\n\n    this.$element.trigger(e);\n\n    return e;\n  },\n\n  shown() {\n    const { options } = this;\n\n    this.transitioning = false;\n    this.fulled = true;\n    this.visible = true;\n    this.render();\n    this.bind();\n\n    if ($.isFunction(options.shown)) {\n      this.$element.one(EVENT_SHOWN, options.shown);\n    }\n\n    this.trigger(EVENT_SHOWN);\n  },\n\n  hidden() {\n    const { options } = this;\n\n    this.transitioning = false;\n    this.viewed = false;\n    this.fulled = false;\n    this.visible = false;\n    this.unbind();\n    this.$body.removeClass(CLASS_OPEN);\n    this.$viewer.addClass(CLASS_HIDE);\n    this.resetList();\n    this.resetImage();\n\n    if ($.isFunction(options.hidden)) {\n      this.$element.one(EVENT_HIDDEN, options.hidden);\n    }\n\n    this.trigger(EVENT_HIDDEN);\n  },\n\n  requestFullscreen() {\n    if (this.fulled && !document.fullscreenElement && !document.mozFullScreenElement &&\n      !document.webkitFullscreenElement && !document.msFullscreenElement) {\n      const { documentElement } = document;\n\n      if (documentElement.requestFullscreen) {\n        documentElement.requestFullscreen();\n      } else if (documentElement.msRequestFullscreen) {\n        documentElement.msRequestFullscreen();\n      } else if (documentElement.mozRequestFullScreen) {\n        documentElement.mozRequestFullScreen();\n      } else if (documentElement.webkitRequestFullscreen) {\n        documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n      }\n    }\n  },\n\n  exitFullscreen() {\n    if (this.fulled) {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      }\n    }\n  },\n\n  change(event) {\n    const { pointers } = this;\n    const pointer = pointers[Object.keys(pointers)[0]];\n    const offsetX = pointer.endX - pointer.startX;\n    const offsetY = pointer.endY - pointer.startY;\n\n    switch (this.action) {\n      // Move the current image\n      case ACTION_MOVE:\n        this.move(offsetX, offsetY);\n        break;\n\n      // Zoom the current image\n      case ACTION_ZOOM:\n        this.zoom(getMaxZoomRatio(pointers), false, event);\n\n        this.startX2 = this.endX2;\n        this.startY2 = this.endY2;\n        break;\n\n      case ACTION_SWITCH:\n        this.action = 'switched';\n\n        if (Math.abs(offsetX) > Math.abs(offsetY)) {\n          if (offsetX > 1) {\n            this.prev();\n          } else if (offsetX < -1) {\n            this.next();\n          }\n        }\n\n        break;\n\n      default:\n    }\n\n    // Override\n    $.each(pointers, (i, p) => {\n      p.startX = p.endX;\n      p.startY = p.endY;\n    });\n  },\n\n  isSwitchable() {\n    const { image, viewer } = this;\n\n    return (image.left >= 0 && image.top >= 0 && image.width <= viewer.width &&\n      image.height <= viewer.height);\n  },\n};\n","import $ from 'jquery';\nimport DEFAULTS from './defaults';\nimport TEMPLATE from './template';\nimport render from './render';\nimport events from './events';\nimport handlers from './handlers';\nimport methods from './methods';\nimport others from './others';\nimport {\n  CLASS_CLOSE,\n  CLASS_FADE,\n  CLASS_FIXED,\n  CLASS_FULLSCREEN,\n  CLASS_HIDE,\n  CLASS_INVISIBLE,\n  EVENT_BUILD,\n  EVENT_READY,\n  EVENT_CLICK,\n  EVENT_LOAD,\n  NAMESPACE,\n} from './constants';\nimport {\n  getResponsiveClass,\n} from './utilities';\n\nclass Viewer {\n  /**\n   * Start the new Viewer.\n   * @param {Element} element - The target element for viewing.\n   * @param {Object} [options={}] - The configuration options.\n   */\n  constructor(element, options = {}) {\n    if (!element || element.nodeType !== 1) {\n      throw new Error('The first argument is required and must be an element.');\n    }\n    \n    this.element = element;\n    this.$element = $(element);\n    this.options = $.extend({}, DEFAULTS, $.isPlainObject(options) && options);\n    this.action = '';\n    this.target = null;\n    this.timeout = null;\n    this.index = 0;\n    this.length = 0;\n    this.ready = false;\n    this.fading = false;\n    this.fulled = false;\n    this.isImg = false;\n    this.played = false;\n    this.playing = false;\n    this.tooltiping = false;\n    this.transitioning = false;\n    this.viewed = false;\n    this.visible = false;\n    this.wheeling = false;\n    this.pointers = {};\n    this.init();\n  }\n\n  init() {\n    const { $element, options } = this;\n    const isImg = $element.is('img');\n    const $images = isImg ? $element : $element.find('img');\n    const { length } = $images;\n\n    if (!length) {\n      return;\n    }\n\n    // Override `transition` option if it is not supported\n    if (typeof document.createElement(NAMESPACE).style.transition === 'undefined') {\n      options.transition = false;\n    }\n\n    this.isImg = isImg;\n    this.length = length;\n    this.count = 0;\n    this.$images = $images;\n    this.$body = $('body');\n\n    if (options.inline) {\n      $element.one(EVENT_READY, () => {\n        this.view();\n      });\n\n      $images.each((i, image) => {\n        if (image.complete) {\n          this.progress();\n        } else {\n          $(image).one(EVENT_LOAD, $.proxy(this.progress, this));\n        }\n      });\n    } else {\n      $element.on(EVENT_CLICK, $.proxy(this.start, this));\n    }\n  }\n\n  progress() {\n    this.count += 1;\n\n    if (this.count === this.length) {\n      this.build();\n    }\n  }\n\n  build() {\n    const { $element, options } = this;\n\n    if (this.ready) {\n      return;\n    }\n\n    const $parent = $element.parent();\n    const $viewer = $(TEMPLATE);\n    const $button = $viewer.find(`.${NAMESPACE}-button`);\n    const $navbar = $viewer.find(`.${NAMESPACE}-navbar`);\n    const $title = $viewer.find(`.${NAMESPACE}-title`);\n    const $toolbar = $viewer.find(`.${NAMESPACE}-toolbar`);\n\n    this.$parent = $parent;\n    this.$viewer = $viewer;\n    this.$button = $button;\n    this.$navbar = $navbar;\n    this.$title = $title;\n    this.$toolbar = $toolbar;\n    this.$canvas = $viewer.find(`.${NAMESPACE}-canvas`);\n    this.$footer = $viewer.find(`.${NAMESPACE}-footer`);\n    this.$list = $viewer.find(`.${NAMESPACE}-list`);\n    this.$player = $viewer.find(`.${NAMESPACE}-player`);\n    this.$tooltip = $viewer.find(`.${NAMESPACE}-tooltip`);\n\n    $title.addClass(!options.title ? CLASS_HIDE : getResponsiveClass(options.title));\n    $toolbar.addClass(!options.toolbar ? CLASS_HIDE : getResponsiveClass(options.toolbar));\n    $toolbar.find('li[class*=zoom]').toggleClass(CLASS_INVISIBLE, !options.zoomable);\n    $toolbar.find('li[class*=flip]').toggleClass(CLASS_INVISIBLE, !options.scalable);\n\n    if (!options.rotatable) {\n      $toolbar.find('li[class*=rotate]').addClass(CLASS_INVISIBLE).appendTo($toolbar);\n    }\n\n    $navbar.addClass(!options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n    $button.toggleClass(CLASS_HIDE, !options.button);\n\n    if (options.inline) {\n      $button.addClass(CLASS_FULLSCREEN);\n      $viewer.css('z-index', options.zIndexInline);\n\n      if ($parent.css('position') === 'static') {\n        $parent.css('position', 'relative');\n      }\n\n      $element.after($viewer);\n    } else {\n      $button.addClass(CLASS_CLOSE);\n      $viewer\n        .css('z-index', options.zIndex)\n        .addClass([CLASS_FIXED, CLASS_FADE, CLASS_HIDE].join(' '))\n        .appendTo('body');\n    }\n\n    if (options.inline) {\n      this.render();\n      this.bind();\n      this.visible = true;\n    }\n\n    this.ready = true;\n\n    if ($.isFunction(options.ready)) {\n      $element.one(EVENT_READY, options.ready);\n    }\n\n    this.trigger(EVENT_READY);\n  }\n\n  unbuild() {\n    if (!this.ready) {\n      return;\n    }\n\n    this.ready = false;\n    this.$viewer.remove();\n  }\n\n  /**\n   * Change the default options.\n   * @static\n   * @param {Object} options - The new default options.\n   */\n  static setDefaults(options) {\n    $.extend(DEFAULTS, options);\n  }\n}\n\n$.extend(Viewer.prototype, render, events, handlers, methods, others);\n\nexport default Viewer;\n","import $ from 'jquery';\nimport Viewer from './viewer';\nimport {\n  NAMESPACE,\n} from './constants';\nimport {\n  isString,\n  isUndefined,\n} from './utilities';\n\nconst AnotherViewer = $.fn.viewer;\n\n$.fn.viewer = function jQueryViewer(option, ...args) {\n  let result;\n\n  this.each((i, element) => {\n    const $element = $(element);\n    let data = $element.data(NAMESPACE);\n\n    if (!data) {\n      if (/destroy/.test(option)) {\n        return;\n      }\n\n      const options = $.extend({}, $element.data(), $.isPlainObject(option) && option);\n\n      data = new Viewer(element, options);\n      $element.data(NAMESPACE, data);\n    }\n\n    if (isString(option)) {\n      const fn = data[option];\n\n      if ($.isFunction(fn)) {\n        result = fn.apply(data, args);\n      }\n    }\n  });\n\n  return isUndefined(result) ? this : result;\n};\n\n$.fn.viewer.Constructor = Viewer;\n$.fn.viewer.setDefaults = Viewer.setDefaults;\n$.fn.viewer.noConflict = function noConflict() {\n  $.fn.viewer = AnotherViewer;\n  return this;\n};\n"],"names":["window","PointerEvent","NAMESPACE","ACTION_MOVE","ACTION_SWITCH","ACTION_ZOOM","CLASS_ACTIVE","CLASS_CLOSE","CLASS_FADE","CLASS_FIXED","CLASS_FULLSCREEN","CLASS_FULLSCREEN_EXIT","CLASS_HIDE","CLASS_HIDE_MD_DOWN","CLASS_HIDE_SM_DOWN","CLASS_HIDE_XS_DOWN","CLASS_IN","CLASS_INVISIBLE","CLASS_MOVE","CLASS_OPEN","CLASS_SHOW","CLASS_TRANSITION","EVENT_READY","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_VIEW","EVENT_VIEWED","EVENT_CLICK","EVENT_DRAG_START","EVENT_KEY_DOWN","EVENT_LOAD","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_RESIZE","EVENT_TRANSITIONEND","EVENT_WHEEL","isString","value","isNaN","Number","isNumber","isUndefined","proxy","fn","context","args","args2","apply","concat","objectKeys","Object","keys","obj","each","key","push","getTransformValues","rotate","scaleX","scaleY","values","length","join","getImageNameFromURL","url","replace","getImageNaturalSizes","image","callback","naturalWidth","naturalHeight","newImage","document","createElement","onload","width","height","src","getResponsiveClass","type","getMaxZoomRatio","pointers","pointers2","$","extend","ratios","pointerId","pointer","pointerId2","pointer2","x1","Math","abs","startX","y1","startY","x2","endX","y2","endY","z1","sqrt","z2","ratio","sort","a","b","getPointer","endOnly","pageX","pageY","end","getPointersCenter","count","initContainer","initViewer","initList","renderViewer","$window","container","innerWidth","innerHeight","options","$parent","viewer","inline","max","minWidth","minHeight","parent","fulled","$viewer","css","$element","$list","list","$images","i","alt","getAttribute","isFunction","call","html","find","one","loadImage","$items","children","transition","addClass","index","eq","outerWidth","empty","removeClass","$image","footerHeight","$footer","viewerWidth","viewerHeight","oldImage","aspectRatio","min","initialImage","rotatable","scalable","left","top","transitioning","remove","view","on","viewed","click","wheel","dragstart","$canvas","pointerdown","onPointerMove","pointermove","onPointerUp","pointerup","onKeyDown","keydown","onResize","resize","off","e","$target","target","action","data","played","stop","exit","full","hide","zoom","toggle","reset","prev","play","next","is","preventDefault","keyboard","which","zoomRatio","ctrlKey","shiftKey","timeout","initImage","toggleClass","movable","renderImage","trigger","parentWidth","parentHeight","filled","originalEvent","changedTouches","touch","identifier","pointerType","isSwitchable","hasClass","change","renderList","fullscreen","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","$player","show","wheeling","delta","deltaY","wheelDelta","detail","ready","build","isDefaultPrevented","$body","offsetWidth","shown","visible","hidden","zoomTo","$item","$img","attr","$title","complete","load","setTimeout","offsetX","offsetY","moveTo","x","y","changed","hasTooltip","_event","_zoomable","zoomable","minZoomRatio","maxZoomRatio","newWidth","newHeight","offset","center","tooltip","degree","rotateTo","scale","requestFullscreen","item","append","interval","playing","exitFullscreen","$button","removeAttr","zIndex","zIndexInline","$tooltip","classes","text","round","tooltiping","fading","isImg","destroy","indexes","img","inArray","unbind","start","unbuild","removeData","Event","render","bind","resetList","resetImage","documentElement","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","event","move","startX2","endX2","startY2","endY2","p","Viewer","element","nodeType","Error","DEFAULTS","isPlainObject","init","style","progress","TEMPLATE","$navbar","$toolbar","title","toolbar","appendTo","navbar","button","after","prototype","events","handlers","methods","others","AnotherViewer","jQueryViewer","option","result","test","Constructor","setDefaults","noConflict"],"mappings":"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"}